<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progent — ArcGIS Pro Trusted Agent</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
</head>
<body>
    <div class="app-layout">
        <main class="chat-container">
        <header class="chat-header">
            <div class="title-container">
                <img src="/static/logo.png" alt="Progent logo" class="header-logo">
                <h1>Progent</h1>
                <p class="slogan">ArcGIS Pro Trusted Agent</p>
            </div>
            <div class="header-controls">
                <div class="model-selector">
                    <label for="ai-model-select">AI Model:</label>
                    <select id="ai-model-select">
                        <!-- Options will be populated dynamically -->
                    </select>
                    <button id="api-key-btn" class="api-key-btn" aria-label="Manage API Key">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                            <path d="M12.67 2.05C12.42 2.02 12.16 2 11.89 2c-2.37 0-4.48 1.19-5.77 3.11L4 7.23V4H2v6h6V8H5.23l2.05-3.11C8.36 3.55 10.02 3 11.89 3c.17 0 .34.02.5.05l-1.8 1.8L12 6.27l4.95-4.95-1.41-1.41L12.67 2.05zM21.9 10h-2.03c-.24-1-.65-1.92-1.18-2.72l2.03-2.03-1.13-1.13-6.36 6.36L12 11.73l2.95-2.95c-.72-.27-1.51-.42-2.34-.42-3.03 0-5.72 2.12-6.83 5H3v-2H1v4h4v-2h-1.17C7.71 12.5 10.04 10 13 10c1.2 0 2.3.38 3.25 1.01l2.43-2.43 1.41 1.41L18.17 12H21.9v2h-2.02c-.12.68-.32 1.32-.58 1.92l1.8 1.8 1.41-1.41-6.36-6.36L12 11.73l-2.95 2.95c.72.27 1.51.42 2.34.42 3.03 0 5.72-2.12 6.83-5H19v2h2v-4z"/>
                        </svg>
                    </button>
                </div>
                <div id="api-key-section" class="api-key-section" style="display: none;">
                    <input type="password" id="api-key-input" placeholder="Enter your API key...">
                    <button id="save-api-key-btn" class="btn-primary">Save</button>
                </div>
                <button id="view-dashboard-btn" class="btn-dashboard" style="display: none;">View Dashboard</button>
                <p id="connection-status" class="status-disconnected">Connecting...</p>
            </div>
        </header>

        <section id="chat-messages" class="chat-messages">
            <div class="welcome-message">
                <h3>Hi there,</h3>
                <p>I am your ArcGIS Pro Trusted Agent. I can help you analyze your GIS data, run spatial functions, and provide insights about your ArcGIS Pro project.</p>
                <p>Just type your question or request below, and I'll investigate your data to provide helpful answers.</p>
            </div>
        </section>

        <footer class="chat-input-area">
            <form id="chat-form" class="chat-form">
                <textarea
                    id="user-input"
                    placeholder="Type your message..."
                    rows="1"
                ></textarea>
                <button type="button" id="voice-btn" class="voice-btn" aria-label="Record Voice">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"/>
                    </svg>
                </button>
                <button type="submit" id="send-btn" class="send-btn" aria-label="Send Message">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                    </svg>
                </button>
            </form>
        </footer>
    </main>

    <!-- Dashboard Panel -->
    <aside id="dashboard-panel" class="dashboard-panel">
        <header class="dashboard-header">
            <h2>Dashboard</h2>
            <div class="dashboard-controls">
                <button id="toggle-dashboard" class="btn-secondary">Hide</button>
                <button id="refresh-dashboard" class="btn-primary">Refresh</button>
            </div>
        </header>
        
        <div class="dashboard-content">
            <div id="dashboard-grid" class="dashboard-grid">
                <div class="dashboard-placeholder">
                    <h3>No Dashboard Available</h3>
                    <p>Ask the AI to analyze a layer to generate dashboard insights</p>
                </div>
            </div>
        </div>
    </aside>
    </div>

    <!-- Loading indicator -->
    <div id="loading-indicator" class="loading-indicator" style="display: none;">
        <div class="spinner"></div>
        <p>Thinking...</p>
    </div>

    <!-- Scripts -->
    <script src="/static/script.js"></script>

    <!-- Data Warning Banner -->
    <div id="data-warning-banner" role="alert" aria-live="polite">
        <div class="banner-track">
            <div class="banner-marquee">
                <span>
                    ⚠ DATA PRIVACY NOTICE: This system transmits your prompts and referenced GIS data to external AI services. DO NOT include sensitive, classified, or governmental information. • 
                    ⚠ DATA PRIVACY NOTICE: This system transmits your prompts and referenced GIS data to external AI services. DO NOT include sensitive, classified, or governmental information. • 
                    ⚠ DATA PRIVACY NOTICE: This system transmits your prompts and referenced GIS data to external AI services. DO NOT include sensitive, classified, or governmental information.
                </span>
            </div>
        </div>
    </div>
</body>
</html>

