<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progent — ArcGIS Pro Trusted Agent</title>
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
</head>
<body>
    <div class="app-layout">
        <main class="chat-container">
        <header class="chat-header">
            <div class="title-container">
                <img src="/static/logo.png" alt="Progent logo" class="header-logo">
                <h1>Progent</h1>
                <p class="slogan">ArcGIS Pro Trusted Agent</p>
            </div>
            <div class="header-controls">
                <div class="model-selector">
                    <label for="ai-model-select">AI Model:</label>
                    <select id="ai-model-select">
                        <!-- Options will be populated dynamically -->
                    </select>
                        <button id="api-key-btn" class="api-key-btn" aria-label="Manage API Key" title="Manage API Key">
                            <!-- Key icon (more recognizable) -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20" aria-hidden="true">
                                <path d="M12.65 10A5.99 5.99 0 007 4a6 6 0 000 12 5.99 5.99 0 005.65-4H17l2 2 2-2 2 2 1-1-3-3h-6.35zM7 14a4 4 0 110-8 4 4 0 010 8z"/>
                                <circle cx="7" cy="10" r="1.5"/>
                            </svg>
                        </button>
                </div>
                <div id="api-key-section" class="api-key-section" style="display: none;">
                    <input type="password" id="api-key-input" placeholder="Enter your API key...">
                    <button id="save-api-key-btn" class="btn-primary">Save</button>
                </div>
                <button id="view-dashboard-btn" class="btn-dashboard" style="display: none;">View Dashboard</button>
                <p id="connection-status" class="status-disconnected">Connecting...</p>
            </div>
        </header>

        <section id="chat-messages" class="chat-messages">
            <div class="welcome-message">
                <h3>Hi there,</h3>
                <p>I am your ArcGIS Pro Trusted Agent. I can help you analyze your GIS data, run spatial functions, and provide insights about your ArcGIS Pro project.</p>
                <p>Just type your question or request below, and I'll investigate your data to provide helpful answers.</p>
            </div>
        </section>

        <footer class="chat-input-area">
            <form id="chat-form" class="chat-form">
                <textarea
                    id="user-input"
                    placeholder="Type your message..."
                    rows="1"
                ></textarea>
                <button type="button" id="voice-btn" class="voice-btn" aria-label="Record Voice">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"/>
                    </svg>
                </button>
                <button type="submit" id="send-btn" class="send-btn" aria-label="Send Message">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                    </svg>
                </button>
            </form>
        </footer>
        <!-- Data Warning Banner -->
        <div id="data-warning-banner" role="alert" aria-live="polite">
            <div class="banner-track">
                <div class="banner-marquee">
                    <span>
                        ⚠ DATA PRIVACY NOTICE: This system transmits your prompts and referenced GIS data to external AI services. DO NOT include sensitive, classified, or governmental information. •
                        ⚠ DATA PRIVACY NOTICE: This system transmits your prompts and referenced GIS data to external AI services. DO NOT include sensitive, classified, or governmental information. •
                        ⚠ DATA PRIVACY NOTICE: This system transmits your prompts and referenced GIS data to external AI services. DO NOT include sensitive, classified, or governmental information.
                    </span>
                </div>
            </div>
        </div>
    </main>

    <!-- Dashboard Panel -->
    <aside id="dashboard-panel" class="dashboard-panel">
        <header class="dashboard-header">
            <h2>Dashboard</h2>
            <div class="dashboard-controls">
                <button id="toggle-dashboard" class="btn-secondary">Hide</button>
                <button id="refresh-dashboard" class="btn-primary">Refresh</button>
            </div>
        </header>
        
        <div class="dashboard-content">
            <div id="dashboard-grid" class="dashboard-grid">
                <div class="dashboard-placeholder">
                    <h3>No Dashboard Available</h3>
                    <p>Ask the AI to analyze a layer to generate dashboard insights</p>
                </div>
            </div>
        </div>
    </aside>
    </div>

    <!-- Loading indicator -->
    <div id="loading-indicator" class="loading-indicator" style="display: none;">
        <div class="spinner"></div>
        <p>Thinking...</p>
    </div>

    <!-- Scripts -->
    <script src="/static/script.js"></script>
</body>
</html>

